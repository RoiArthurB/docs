---
sidebar_position: 3
---

# Push server file

The server file needs to be copied to the device and executed on it. It will listen on a UNIX domain socket and wait for connections from the client.

The default path of the server file on device is `/data/local/tmp/scrcpy-server.jar`. Before version 2.3, the path of Scrcpy server binary is hard-coded in the server itself. So you must push it to this exact path, otherwise the clean up steps won't delete the server file.

<Tabs className="runtime-tabs">
<TabItem label="Tango" value="tango">

It uses [`AdbSync#write`](../tango/commands/sync/write.md) method to write a file stream to the device.

```ts transpile
import type { Adb } from "@yume-chan/adb";
import { ReadableStream } from "@yume-chan/stream-extra";

declare const adb: Adb;
declare const server: ArrayBuffer;

const sync = await adb.sync();
try {
  await sync.write({
    filename: "/data/local/tmp/scrcpy-server.jar",
    file: new ReadableStream({
      start(controller) {
        controller.enqueue(new Consumable(new Uint8Array(server)));
        controller.close();
      },
    }),
  });
} finally {
  await sync.dispose();
}
```

</TabItem>
<TabItem label="Tango Scrcpy" value="client">

`@yume-chan/adb-scrcpy` package provides a `pushServer` function as a shortcut for the Tango `AdbSync#write` call.

```ts transpile
import type { Adb } from "@yume-chan/adb";
import { AdbScrcpyClient } from "@yume-chan/adb-scrcpy";
import { ReadableStream } from "@yume-chan/stream-extra";

declare const adb: Adb;
declare const server: ArrayBuffer;

await AdbScrcpyClient.pushServer(
  adb,
  new ReadableStream({
    start(controller) {
      controller.enqueue(new Consumable(new Uint8Array(server)));
      controller.close();
    },
  }),
);
```

By default, it pushes to `/data/local/tmp/scrcpy-server.jar`. You can specify a different path by passing the third argument.

```ts transpile
await AdbScrcpyClient.pushServer(
  adb,
  new ReadableStream({
    start(controller) {
      controller.enqueue(new Consumable(new Uint8Array(server)));
      controller.close();
    },
  }),
  "/data/local/tmp/scrcpy-server.jar",
);
```

</TabItem>
<TabItem label="Shell" value="shell">

This shows the equivalent ADB command:

```bash
adb push scrcpy-server.jar /data/local/tmp/scrcpy-server.jar
```

</TabItem>
</Tabs>
